CREATE TABLE CAJEROS(
CODIGO INTEGER,
NOMAPELS CHARACTER(30),
PRIMARY KEY(CODIGO))

CREATE TABLE PRODUCTOS(
CODIGO INTEGER,
NOMBRE CHARACTER(50),
PRECIO INTEGER,
PRIMARY KEY(CODIGO))

CREATE TABLE MAQUINAS(
CODIGO INTEGER,
PISO INTEGER,
PRIMARY KEY(CODIGO))

CREATE TABLE VENTAS(
CAJERO INTEGER,
MAQUINA INTEGER,
PRODUCTO INTEGER,
FOREIGN KEY(CAJERO) REFERENCES CAJEROS(CODIGO),
FOREIGN KEY(MAQUINA) REFERENCES MAQUINAS(CODIGO),
FOREIGN KEY(PRODUCTO) REFERENCES PRODUCTOS(CODIGO))

INSERT INTO CAJEROS VALUES(1,'CARLOS PEREZ');
INSERT INTO CAJEROS VALUES(2,'MARIA ROJAS');
INSERT INTO CAJEROS VALUES(3,'ANA MARTINEZ');
INSERT INTO CAJEROS VALUES(4,'SAUL CASTRO');
SELECT * FROM CAJEROS

INSERT INTO PRODUCTOS VALUES(1,'BALON GOLTY',40000);
INSERT INTO PRODUCTOS VALUES(2,'BALON ADIDAS',80000);
INSERT INTO PRODUCTOS VALUES(3,'BALON MIKASA',60000);
INSERT INTO PRODUCTOS VALUES(4,'BATE MADERA',100000);
INSERT INTO PRODUCTOS VALUES(5,'BATE ALUMINIO',70000);
INSERT INTO PRODUCTOS VALUES(6,'BICICLETA TODO TERRENO',800000);
INSERT INTO PRODUCTOS VALUES(7,'BICICLETA ESTATICA',1200000);
INSERT INTO PRODUCTOS VALUES(8,'ELIPTICA',1500000);
INSERT INTO PRODUCTOS VALUES(9,'MESA PING PONG',500000);
INSERT INTO PRODUCTOS VALUES(10,'RAQUETA',90000);
INSERT INTO PRODUCTOS VALUES(11,'MANILLA WILSON',110000);
SELECT * FROM PRODUCTOS

INSERT INTO MAQUINAS VALUES(1,1);
INSERT INTO MAQUINAS VALUES(2,1);
INSERT INTO MAQUINAS VALUES(3,2);
INSERT INTO MAQUINAS VALUES(4,2);
SELECT * FROM MAQUINAS

INSERT INTO VENTAS VALUES(1,1,2);
INSERT INTO VENTAS VALUES(1,1,5);
INSERT INTO VENTAS VALUES(1,3,1);
INSERT INTO VENTAS VALUES(1,3,2);
INSERT INTO VENTAS VALUES(2,2,1);
INSERT INTO VENTAS VALUES(2,2,2);
INSERT INTO VENTAS VALUES(2,2,3);
INSERT INTO VENTAS VALUES(2,2,1);
INSERT INTO VENTAS VALUES(2,2,2);
INSERT INTO VENTAS VALUES(2,2,3);
INSERT INTO VENTAS VALUES(2,2,8);
INSERT INTO VENTAS VALUES(2,3,7);
INSERT INTO VENTAS VALUES(2,3,4);
INSERT INTO VENTAS VALUES(3,4,6);
INSERT INTO VENTAS VALUES(3,4,9);
INSERT INTO VENTAS VALUES(3,4,10);
INSERT INTO VENTAS VALUES(3,4,5);
INSERT INTO VENTAS VALUES(3,4,10);
INSERT INTO VENTAS VALUES(3,3,2);
INSERT INTO VENTAS VALUES(3,3,1);
INSERT INTO VENTAS VALUES(1,3,8);

------------------------------ TALLER 5 SQL -----------------------------------
--PUNTO 1
SELECT CODIGO, NOMBRE, COUNT(*) Nro_Ventas FROM PRODUCTOS, VENTAS
WHERE CODIGO=PRODUCTO
GROUP BY CODIGO, NOMBRE
ORDER BY NRO_VENTAS DESC

--SOLUCIÃ“N PARA INCLUIR LOS PRODUCTOS QUE NO TIENEN VENTAS REGISTRADAS
SELECT CODIGO, NOMBRE, COUNT(PRODUCTO) Nro_Ventas FROM PRODUCTOS LEFT JOIN VENTAS
ON CODIGO=PRODUCTO
GROUP BY CODIGO, NOMBRE
--HAVING count(producto) > 1 --ESTO NO HACE PARTE DE LA SOLUCION
ORDER BY NRO_VENTAS DESC

--PUNTO 2
SELECT NOMAPELS, NOMBRE, PRECIO, PISO FROM PRODUCTOS P, CAJEROS C, VENTAS V, MAQUINAS M
WHERE P.CODIGO=V.PRODUCTO AND C.CODIGO=V.CAJERO AND M.CODIGO=V.MAQUINA
ORDER BY NOMAPELS, NOMBRE, PISO

--PUNTO 3
SELECT PISO, SUM(PRECIO) FROM PRODUCTOS P, VENTAS V, MAQUINAS M
WHERE P.CODIGO=V.PRODUCTO AND M.CODIGO=V.MAQUINA
GROUP BY PISO
--HAVING SUM(PRECIO)>3000000 ESTO NO HACE PARTE DE LA SOLUCION

--PUNTO 4
SELECT C.CODIGO, NOMAPELS, SUM(PRECIO) FROM PRODUCTOS P, VENTAS V, CAJEROS C
WHERE P.CODIGO=V.PRODUCTO AND C.CODIGO=V.CAJERO
GROUP BY C.CODIGO, NOMAPELS

--SOLUCION QUE INCLUYE LOS CAJEROS QUE NO TIENEN VENTAS REGISTRADAS
SELECT C.CODIGO, NOMAPELS, SUM(PRECIO) FROM PRODUCTOS P JOIN VENTAS V ON P.CODIGO=V.PRODUCTO
RIGHT JOIN CAJEROS C ON C.CODIGO=V.CAJERO
GROUP BY C.CODIGO, NOMAPELS

--PUNTO 5
SELECT CODIGO, NOMAPELS FROM CAJEROS
WHERE CODIGO IN (SELECT CAJERO FROM VENTAS V, MAQUINAS M WHERE V.MAQUINA=M.CODIGO AND
		 PISO IN (SELECT PISO FROM PRODUCTOS P, VENTAS V, MAQUINAS M
                          WHERE P.CODIGO=V.PRODUCTO AND M.CODIGO=V.MAQUINA
                          GROUP BY PISO
                          HAVING SUM(PRECIO)<3000000))
















